#!/bin/bash
ntests=`ls test | wc -l`
ls test | sort -R | awk '{printf("test/%s\n", $1)}' | tee >(head -n "$(( $ntests / 4 * 1))" | tail -n "$(( $ntests / 4))" | xargs mocha -R progress) >(head -n "$(( $ntests / 4 * 2))" | tail -n "$(( $ntests / 4))" | xargs mocha -R progress) >(head -n "$(( $ntests / 4 * 3))" | tail -n "$(( $ntests / 4))" | xargs mocha -R progress) >(head -n "$(( $ntests / 4 * 4 + ( $ntests % 4 ) ))" | tail -n "$(( $ntests / 4 + ( $ntests % 4) ))" | xargs mocha -R progress) > /dev/null
